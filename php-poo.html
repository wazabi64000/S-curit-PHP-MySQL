<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PHP POO ‚Äî Cours S√©curit√© PHP & MySQL</title>
  <link rel="stylesheet" href="assets/style.css" />
  <script defer src="assets/site.js"></script>
</head>
<body>
  <a href="#contenu" class="skip-link">Aller au contenu</a>
  <header class="site-header" role="banner">
    <div class="container navbar">
      <a class="brand" href="index.html" aria-label="Accueil">
        <span class="logo">SP</span>
        <span>S√©curit√© PHP & MySQL</span>
      </a>
      <button class="nav-toggle" aria-controls="primary-nav" aria-expanded="false" aria-label="Ouvrir le menu">
        <span class="bar"></span><span aria-hidden="true">Menu</span>
      </button>
      <nav id="primary-nav" class="nav" aria-label="Navigation principale">
        <ul>
          <li><a href="index.html">Introduction</a></li>
          <li><a href="php-poo.html">PHP POO</a></li>
          <li><a href="mysql.html">MySQL & PDO</a></li>
          <li><a href="vulnerabilites.html">Vuln√©rabilit√©s</a></li>
          <li><a href="securisation.html">S√©curisation</a></li>
          <li><a href="modules.html">Modules & Outils</a></li>
          <li><a href="projet.html">Projet final</a></li>
          <li><a href="exercices.html">Exercices</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="contenu" class="container">

    <!-- HERO -->
    <section class="hero card">
      <h1>üß± Bases de PHP Orient√© Objet</h1>
      <p>
        La POO te permet d‚Äôorganiser ton code comme une brigade de cuisine :  
        chaque chef (classe) a un r√¥le pr√©cis et pr√©pare un plat (objet) selon une recette (m√©thodes).  
        Cela rend ton code plus clair, r√©utilisable et plus facile √† s√©curiser.
      </p>
    </section>

    <!-- 1. Th√©orie -->
    <section class="card">
      <h2>1) Introduction √† la POO</h2>
      <p>La POO permet de : </p>
      <ul>
        <li>Organiser le code en <strong>entit√©s logiques</strong> (classes)</li>
        <li>Cr√©er des <strong>objets</strong> r√©utilisables</li>
        <li>Encapsuler la logique pour prot√©ger les donn√©es</li>
        <li>Am√©liorer la s√©curit√© et la maintenance</li>
      </ul>
      <p>üí° Exemple : cr√©er une classe <code>User</code> pour g√©rer les utilisateurs :</p>
      <pre><code class="php">
class User {
    private $username;       // Le nom de l'utilisateur (propri√©t√© priv√©e)
    private $passwordHash;   // Le mot de passe hach√©

    public function __construct($username, $passwordHash) {
        $this->username = $username;
        $this->passwordHash = $passwordHash;
    }

    public function getUsername() {
        return $this->username;
    }

    public function verifyPassword($password) {
        // V√©rifie que le mot de passe correspond au hash
        return password_verify($password, $this->passwordHash);
    }
}
      </code></pre>
      <p>üí° Analogie : la classe = plan de recette, l‚Äôobjet = plat pr√©par√©.</p>
    </section>

    <!-- 2. Exemple vuln√©rable -->
    <section class="card">
      <h2>2) Exemple sans protection</h2>
      <div class="example">
        <p>Version simple mais vuln√©rable : mots de passe en clair et concat√©nation SQL.</p>
        <pre><code class="php">
// login_vuln.php
$user = $_POST['username'];
$pass = $_POST['password'];

// ‚ùå Mauvaise pratique : concat√©nation directe
$sql  = "SELECT * FROM users WHERE username = '$user' AND password = '$pass'";
$stmt = $pdo->query($sql);

if ($stmt && $stmt->rowCount() > 0) {
    echo "‚úÖ Bienvenue $user (mais vuln√©rable !)";
} else {
    echo "‚ùå Identifiants invalides";
}
        </code></pre>
        <p>‚ö†Ô∏è Probl√®mes : injection SQL possible, mots de passe en clair, pas de s√©paration logique.</p>
      </div>
    </section>

    <!-- 3. Exemple s√©curis√© -->
    <section class="card">
      <h2>3) Exemple avec protection</h2>
      <div class="secure">
        <p>
          Version s√©curis√©e avec POO, PDO et mots de passe hach√©s. On encapsule la logique dans une classe.
        </p>
        <pre><code class="php">
// LoginService.php
class LoginService {
    private $pdo;

    public function __construct($pdo) {
        $this->pdo = $pdo;
    }

    public function login($username, $password) {
        // ‚úÖ Requ√™te pr√©par√©e pour √©viter l'injection SQL
        $stmt = $this->pdo->prepare("SELECT username, password FROM users WHERE username = :u");
        $stmt->execute([':u' => $username]);
        $user = $stmt->fetch();

        // ‚úÖ V√©rification s√©curis√©e du mot de passe
        if ($user && password_verify($password, $user['password'])) {
            return "‚úÖ Bienvenue $username (s√©curis√©)";
        }
        return "‚ùå Identifiants invalides";
    }
}

// Utilisation
$loginService = new LoginService($pdo);
echo $loginService->login($_POST['username'], $_POST['password']);
        </code></pre>
        <p>üí° Ici, la classe <code>LoginService</code> g√®re toute la logique d‚Äôauthentification.  
        Les entr√©es utilisateurs sont s√©curis√©es et les mots de passe sont hach√©s.</p>
      </div>
    </section>

    <!-- 4. R√©sum√© -->
    <section class="card">
      <h2>4) R√©sum√© et bonnes pratiques POO</h2>
      <ul>
        <li>Mod√©liser les entit√©s avec des classes : <code>User</code>, <code>Post</code>, <code>Database</code></li>
        <li>Encapsuler les propri√©t√©s avec <code>private</code> et utiliser getters/setters</li>
        <li>Isoler la logique de s√©curit√© dans des classes sp√©cifiques</li>
        <li>Ne jamais concat√©ner directement les entr√©es utilisateurs dans SQL</li>
        <li>Utiliser <code>password_hash</code> et <code>password_verify</code> pour s√©curiser les mots de passe</li>
        <li>Ajouter des commentaires et explications pour chaque √©tape</li>
      </ul>
      <p>üí° Mini-exercice : cr√©er une classe <code>Post</code> avec titre et contenu, et une m√©thode pour afficher l‚Äôarticle en √©chappant les caract√®res sp√©ciaux.</p>
    </section>

  </main>

  <footer role="contentinfo">
    <div class="container">
      <p>¬© PHP POO ¬∑ Cours p√©dagogique ‚Äî PHP POO ¬∑ MySQL ¬∑ S√©curit√© ¬∑ Accessibilit√©</p>
    </div>
  </footer>
</body>
</html>
