<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Introduction â€” Cours SÃ©curitÃ© PHP & MySQL</title>
  <link rel="stylesheet" href="assets/style.css" />
  <script defer src="assets/site.js"></script>
</head>
<body>
  <a href="#contenu" class="skip-link">Aller au contenu</a>
  <header class="site-header" role="banner">
    <div class="container navbar">
      <a class="brand" href="index.html" aria-label="Accueil">
        <span class="logo">SP</span>
        <span>SÃ©curitÃ© PHP & MySQL</span>
      </a>
      <button class="nav-toggle" aria-controls="primary-nav" aria-expanded="false" aria-label="Ouvrir le menu">
        <span class="bar"></span><span aria-hidden="true">Menu</span>
      </button>
      <nav id="primary-nav" class="nav" aria-label="Navigation principale">
        <ul>
          <li><a href="index.html">Introduction</a></li>
          <li><a href="php-poo.html">PHP POO</a></li>
          <li><a href="mysql.html">MySQL & PDO</a></li>
          <li><a href="vulnerabilites.html">VulnÃ©rabilitÃ©s</a></li>
          <li><a href="securisation.html">SÃ©curisation</a></li>
          <li><a href="modules.html">Modules & Outils</a></li>
          <li><a href="projet.html">Projet final</a></li>
          <li><a href="exercices.html">Exercices</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="contenu" class="container">
    
    <section class="hero card">
      <h1>ğŸ” Introduction : Comprendre la SÃ©curitÃ© Web</h1>
      <p>
        Imagine un restaurant :  
        - Le <strong>client</strong> = lâ€™utilisateur qui passe une commande.<br>
        - Le <strong>serveur</strong> = le cuisinier qui prÃ©pare le plat.<br>
        - La <strong>cuisine</strong> = la base de donnÃ©es oÃ¹ sont stockÃ©s les ingrÃ©dients.<br>
      </p>
      <p>
        Normalement, tout est bien organisÃ©. Mais certains Â« clients Â» essaient de 
        <strong>tricher</strong> : entrer en cuisine sans autorisation, voler des recettes ou 
        modifier les plats. Câ€™est exactement ce que font les pirates avec une application web.  
      </p>
    </section>

    <section class="card">
      <h2>1) ThÃ©orie : comment circule lâ€™information</h2>
      <p>
        Quand tu te connectes Ã  un site, voici ce qui se passe :
      </p>
      <ol>
        <li>Tu Ã©cris ton nom dâ€™utilisateur et ton mot de passe.</li>
        <li>Le navigateur envoie ces informations au serveur (en PHP).</li>
        <li>PHP pose une question Ã  la base de donnÃ©es MySQL : Â« Cet utilisateur existe-t-il ? Â»</li>
        <li>MySQL rÃ©pond oui ou non, et PHP affiche la bonne page.</li>
      </ol>
      <p>
        Si le dÃ©veloppeur nâ€™a pas fait attention, un pirate peut <strong>casser ce dialogue</strong> 
        et tricher. Câ€™est ce quâ€™on appelle une <em>vulnÃ©rabilitÃ©</em>.
      </p>
    </section>


    <section class="card">
  <h2>ğŸ› ï¸ PrÃ©parer son environnement</h2>
  <p>
    Avant de commencer les tests de sÃ©curitÃ©, il faut installer et configurer un petit 
    environnement de dÃ©veloppement. Pas besoin dâ€™un vrai serveur compliquÃ© !
  </p>

  <h3>1) Installer un serveur local</h3>
  <ul>
    <li>ğŸ‘‰ TÃ©lÃ©charge et installe <strong>XAMPP</strong>, <strong>MAMP</strong> ou <strong>Laragon</strong> (selon ton systÃ¨me).</li>
    <li>Ces outils installent automatiquement <strong>PHP</strong>, <strong>MySQL</strong> et <strong>phpMyAdmin</strong>.</li>
    <li>Une fois installÃ©, lance <strong>Apache</strong> (pour PHP) et <strong>MySQL</strong>.</li>
    <li>Ouvre <code>http://localhost/</code> dans ton navigateur : si tu vois une page dâ€™accueil, tout est prÃªt âœ…</li>
  </ul>

  <h3>2) CrÃ©er une base de donnÃ©es</h3>
  <p>On va crÃ©er une petite base appelÃ©e <code>cours_securite</code>.</p>
  <pre><code class="sql">
CREATE DATABASE cours_securite CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
USE cours_securite;
  </code></pre>

  <h3>3) CrÃ©er une table "users"</h3>
  <p>La table contiendra des utilisateurs avec un identifiant, un nom et un mot de passe.</p>
  <pre><code class="sql">
CREATE TABLE users (
  id INT AUTO_INCREMENT PRIMARY KEY,
  username VARCHAR(50) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL
);
  </code></pre>

  <h3>4) Ajouter un utilisateur test</h3>
  <p>On crÃ©e un utilisateur <strong>alice</strong> avec le mot de passe <strong>secret123</strong>.</p>
  <p>Mais attention : dans la version sÃ©curisÃ©e, les mots de passe doivent Ãªtre <strong>hachÃ©s</strong>.</p>

  <p>ğŸ‘‰ Dans un petit fichier PHP, tape :</p>
  <pre><code class="php">
< ?php
echo password_hash("secret123", PASSWORD_DEFAULT);
  </code></pre>

  <p>Tu obtiendras quelque chose comme :</p>
  <pre><code>
$2y$10$7abcdeFâ€¦etcâ€¦
  </code></pre>

  <p>Ensuite, insÃ¨re lâ€™utilisateur dans MySQL :</p>
  <pre><code class="sql">
INSERT INTO users (username, password) 
VALUES ('alice', '$2y$10$7abcdeFetcetcetcetc');
  </code></pre>

  <h3>5) CrÃ©er les fichiers PHP</h3>

  <h4>a) Version vulnÃ©rable</h4>
  <p>Ce code concatÃ¨ne directement les entrÃ©es utilisateur dans la requÃªte SQL â†’ il est <strong>dangereux</strong>.</p>
  <pre><code class="php">
// login_vulnerable.php
<?php
$dsn = "mysql:host=localhost;dbname=cours_securite;charset=utf8mb4";
$db_user = "root";
$db_pass = "";

try {
  $pdo = new PDO($dsn, $db_user, $db_pass);
} catch (PDOException $e) {
  die("Erreur de connexion : " . $e->getMessage());
}

$username = $_POST['username'];
$password = $_POST['password'];

// âŒ Mauvaise pratique : concatÃ©nation directe
$sql = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";
$stmt = $pdo->query($sql);

if ($stmt && $stmt->rowCount() > 0) {
  echo "âœ… Bienvenue $username (mais ce code est vulnÃ©rable !)";
} else {
  echo "âŒ Identifiants invalides";
}
?>
  </code></pre>

  <p>ğŸ‘‰ Essaie de te connecter avec :</p>
  <ul>
    <li><strong>Utilisateur :</strong> <code>' OR '1'='1</code></li>
    <li><strong>Mot de passe :</strong> (laisse vide)</li>
  </ul>
  <p>Tu verras que lâ€™accÃ¨s est accordÃ© sans mot de passe ! âš ï¸</p>

  <h4>b) Version sÃ©curisÃ©e</h4>
  <p>Ici on utilise <strong>PDO + requÃªtes prÃ©parÃ©es</strong> et la vÃ©rification des mots de passe hachÃ©s.</p>
  <pre><code class="php">
// login_secure.php
<?php
$dsn = "mysql:host=localhost;dbname=cours_securite;charset=utf8mb4";
$db_user = "root";
$db_pass = "";

try {
  $pdo = new PDO($dsn, $db_user, $db_pass, [
    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC
  ]);
} catch (PDOException $e) {
  die("Erreur de connexion : " . $e->getMessage());
}

$username = $_POST['username'];
$password = $_POST['password'];

// âœ… Bonne pratique : requÃªte prÃ©parÃ©e
$sql = "SELECT * FROM users WHERE username = :username";
$stmt = $pdo->prepare($sql);
$stmt->execute(['username' => $username]);
$user = $stmt->fetch();

if ($user && password_verify($password, $user['password'])) {
  echo "âœ… Bienvenue $username (connexion sÃ©curisÃ©e)";
} else {
  echo "âŒ Identifiants invalides";
}
?>
  </code></pre>

  <p> Maintenant, si tu rÃ©essayes lâ€™injection <code>' OR '1'='1</code>, elle ne marche plus ğŸ‰</p>

</section>


    <section class="card">
      <h2>2) Exemple sans protection</h2>
      <div class="example">
        <p><strong>Formulaire de connexion vulnÃ©rable :</strong></p>
        <form method="POST" action="login_vulnerable.php">
          <label>Utilisateur <input type="text" name="username" required></label>
          <label>Mot de passe <input type="password" name="password" required></label>
          <button type="submit">Se connecter</button>
        </form>
        <p>
          âš ï¸ Dans ce formulaire, les informations sont envoyÃ©es au fichier 
          <code>login_vulnerable.php</code>. Ce fichier met directement les donnÃ©es de lâ€™utilisateur 
          dans la requÃªte SQL, sans vÃ©rifier si elles sont propres.  
        </p>
        <p>
          ğŸ‘‰ Cela permet Ã  un pirate de taper quelque chose comme 
          <code>' OR '1'='1</code> dans le champ Â« utilisateur Â» et de se connecter 
          <strong>sans mot de passe</strong>. Câ€™est ce quâ€™on appelle une <strong>injection SQL</strong>.
        </p>
      </div>
    </section>

    <section class="card">
      <h2>3) Exemple avec protection</h2>
      <div class="secure">
        <p><strong>Formulaire sÃ©curisÃ© :</strong></p>
        <form method="POST" action="login_secure.php">
          <label>Utilisateur <input type="text" name="username" required autocomplete="username"></label>
          <label>Mot de passe <input type="password" name="password" required autocomplete="current-password"></label>
          <button type="submit">Se connecter</button>
        </form>
        <p>
          âœ… Cette fois, le fichier <code>login_secure.php</code> utilise 
          <strong>PDO et des requÃªtes prÃ©parÃ©es</strong>. Cela veut dire que :
        </p>
        <ul>
          <li>Les donnÃ©es de lâ€™utilisateur sont traitÃ©es comme du texte, pas comme du code.</li>
          <li>Impossible dâ€™ajouter une commande SQL cachÃ©e.</li>
          <li>Les mots de passe sont stockÃ©s avec <code>password_hash</code> et vÃ©rifiÃ©s avec <code>password_verify</code>.</li>
          <li>Les cookies de session sont protÃ©gÃ©s avec les options <code>HttpOnly</code> et <code>Secure</code>.</li>
        </ul>
        <p>
          ğŸ‘‰ RÃ©sultat : mÃªme si un pirate essaie dâ€™injecter du code dans le champ utilisateur, 
          MySQL lâ€™ignorera et la connexion Ã©chouera.
        </p>
      </div>
    </section>

  </main>

  <footer role="contentinfo">
    <div class="container">
      <p>Â© Introduction Â· Cours pÃ©dagogique â€” PHP POO Â· MySQL Â· SÃ©curitÃ© Â· AccessibilitÃ©</p>
    </div>
  </footer>
</body>
</html>
